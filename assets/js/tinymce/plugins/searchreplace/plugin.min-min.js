!function(){function e(e,t,n,r,i){function s(e,t){if(t=t||0,!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var n=e.index;if(t>0){var r=e[t];if(!r)throw"Invalid capture group";n+=e[0].indexOf(r),e[0]=r}return[n,n+e[0].length,[e[0]]]}function o(e){var t;if(3===e.nodeType)return e.data;if(p[e.nodeName]&&!h[e.nodeName])return"";if(t="",(h[e.nodeName]||d[e.nodeName])&&(t+="\n"),e=e.firstChild)do t+=o(e);while(e=e.nextSibling);return t}function u(e,t,n){var r,i,s,o,u=[],a=0,f=e,l=t.shift(),c=0;e:for(;;){if((h[f.nodeName]||d[f.nodeName])&&a++,3===f.nodeType&&(!i&&f.length+a>=l[1]?(i=f,o=l[1]-a):r&&u.push(f),!r&&f.length+a>l[0]&&(r=f,s=l[0]-a),a+=f.length),r&&i){if(f=n({startNode:r,startNodeIndex:s,endNode:i,endNodeIndex:o,innerNodes:u,match:l[2],matchIndex:c}),a-=i.length-o,r=null,i=null,u=[],l=t.shift(),c++,!l)break}else{if((!p[f.nodeName]||h[f.nodeName])&&f.firstChild){f=f.firstChild;continue}if(f.nextSibling){f=f.nextSibling;continue}}for(;;){if(f.nextSibling){f=f.nextSibling;break}if(f.parentNode===e)break e;f=f.parentNode}}}function a(e){var t;if("function"!=typeof e){var n=e.nodeType?e:c.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(c.createTextNode(e)),r}}else t=e;return function(e){var n,r,i,s=e.startNode,o=e.endNode,u=e.matchIndex;if(s===o){var a=s;i=a.parentNode,e.startNodeIndex>0&&(n=c.createTextNode(a.data.substring(0,e.startNodeIndex)),i.insertBefore(n,a));var f=t(e.match[0],u);return i.insertBefore(f,a),e.endNodeIndex<a.length&&(r=c.createTextNode(a.data.substring(e.endNodeIndex)),i.insertBefore(r,a)),a.parentNode.removeChild(a),f}n=c.createTextNode(s.data.substring(0,e.startNodeIndex)),r=c.createTextNode(o.data.substring(e.endNodeIndex));for(var l=t(s.data.substring(e.startNodeIndex),u),h=[],p=0,d=e.innerNodes.length;d>p;++p){var v=e.innerNodes[p],m=t(v.data,u);v.parentNode.replaceChild(m,v),h.push(m)}var g=t(o.data.substring(0,e.endNodeIndex),u);return i=s.parentNode,i.insertBefore(n,s),i.insertBefore(l,s),i.removeChild(s),i=o.parentNode,i.insertBefore(g,o),i.insertBefore(r,o),i.removeChild(o),g}}var f,l,c,h,p,d,v=[],m=0;if(c=t.ownerDocument,h=i.getBlockElements(),p=i.getWhiteSpaceElements(),d=i.getShortEndedElements(),l=o(t)){if(e.global)for(;f=e.exec(l);)v.push(s(f,r));else f=l.match(e),v.push(s(f,r));return v.length&&(m=v.length,u(t,v,a(n))),m}}function t(t){function n(){function e(){i.statusbar.find("#next").disabled(!o(l+1).length),i.statusbar.find("#prev").disabled(!o(l-1).length)}function n(){tinymce.ui.MessageBox.alert("Could not find the specified string.",function(){i.find("#find")[0].focus()})}var r={},i=tinymce.ui.Factory.create({type:"window",layout:"flex",pack:"center",align:"center",onClose:function(){t.focus(),f.done()},onSubmit:function(t){var s,u,a,h;return t.preventDefault(),u=i.find("#case").checked(),h=i.find("#words").checked(),a=i.find("#find").value(),a.length?r.text==a&&r.caseState==u&&r.wholeWord==h?0===o(l+1).length?(n(),void 0):(f.next(),e(),void 0):(s=f.find(a,u,h),s||n(),i.statusbar.items().slice(1).disabled(0===s),e(),r={text:a,caseState:u,wholeWord:h},void 0):(f.done(!1),i.statusbar.items().slice(1).disabled(!0),void 0)},buttons:[{text:"Find",onclick:function(){i.submit()}},{text:"Replace",disabled:!0,onclick:function(){f.replace(i.find("#replace").value())||(i.statusbar.items().slice(1).disabled(!0),l=-1,r={})}},{text:"Replace all",disabled:!0,onclick:function(){f.replace(i.find("#replace").value(),!0,!0),i.statusbar.items().slice(1).disabled(!0),r={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){f.prev(),e()}},{text:"Next",name:"next",disabled:!0,onclick:function(){f.next(),e()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:t.selection.getNode().src},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}}).renderTo().reflow()}function r(e){var t=e.getAttribute("data-mce-index");return"number"==typeof t?""+t:t}function i(n){var r,i;return i=t.dom.create("span",{"data-mce-bogus":1}),i.className="mce-match-marker",r=t.getBody(),f.done(!1),e(n,r,i,!1,t.schema)}function s(e){var t=e.parentNode;t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function o(e){var n,i=[];if(n=tinymce.toArray(t.getBody().getElementsByTagName("span")),n.length)for(var s=0;s<n.length;s++){var o=r(n[s]);null!==o&&o.length&&o===e.toString()&&i.push(n[s])}return i}function u(e){var n=l,r=t.dom;e=e!==!1,e?n++:n--,r.removeClass(o(l),"mce-match-marker-selected");var i=o(n);return i.length?(r.addClass(o(n),"mce-match-marker-selected"),t.selection.scrollIntoView(i[0]),n):-1}function a(e){e.parentNode.removeChild(e)}var f=this,l=-1;f.init=function(e){e.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Ctrl+F",onclick:n,separator:"before",context:"edit"}),e.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Ctrl+F",onclick:n}),e.addCommand("SearchReplace",n),e.shortcuts.add("Ctrl+F","",n)},f.find=function(e,t,n){e=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e=n?"\\b"+e+"\\b":e;var r=i(new RegExp(e,t?"g":"gi"));return r&&(l=-1,l=u(!0)),r},f.next=function(){var e=u(!0);-1!==e&&(l=e)},f.prev=function(){var e=u(!1);-1!==e&&(l=e)},f.replace=function(e,n,i){var u,h,p,v,m,g,y=l;for(n=n!==!1,p=t.getBody(),h=tinymce.toArray(p.getElementsByTagName("span")),u=0;u<h.length;u++){var b=r(h[u]);if(null!==b&&b.length)if(v=m=parseInt(b,10),i||v===l){for(e.length?(h[u].firstChild.nodeValue=e,s(h[u])):a(h[u]);h[++u];)if(v=r(h[u]),null!==b&&b.length){if(v!==m){u--;break}a(h[u])}n&&y--}else m>l&&h[u].setAttribute("data-mce-index",m-1)}return t.undoManager.add(),l=y,n?(g=o(y+1).length>0,f.next()):(g=o(y-1).length>0,f.prev()),!i&&g},f.done=function(e){var n,i,o,u;for(i=tinymce.toArray(t.getBody().getElementsByTagName("span")),n=0;n<i.length;n++){var a=r(i[n]);null!==a&&a.length&&(a===l.toString()&&(o||(o=i[n].firstChild),u=i[n].firstChild),s(i[n]))}if(o&&u){var f=t.dom.createRng();return f.setStart(o,0),f.setEnd(u,u.data.length),e!==!1&&t.selection.setRng(f),f}}}tinymce.PluginManager.add("searchreplace",t)}();